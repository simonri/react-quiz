<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("partials/head") %>

    <link href="/static/css/style.css" rel="stylesheet" />

    <style>
      .bold {
        font-weight: bold !important;
      }
      .active_link {
        background-color: none;
        border: 1px solid #ccc;
        background: #f6f6f6;
        border-right: 0px;
        box-shadow: 1px 1px 5px #ccc;
        margin-bottom: 0;
        border-bottom: 0px;
        height: 53px;
      }
      .shadow {
        box-shadow: 0 -0.0055rem 0.5rem rgba(0,0,0,0.3) !important;
      }
      .nav-item {      
        overflow: hidden;
        white-space: nowrap;
      }
      * {
        box-sizing: border-box;
      }
      body {
        font: 16px Arial;  
      }
      /*the container must be positioned relative:*/
      .autocomplete {
        position: relative;
        display: inline-block;
      }
      #searchBtn {
        height: 32px;
      }
      input {
        border: 1px solid transparent;
        background-color: #f1f1f1;
        padding: 10px;
        font-size: 16px;
      }
      input[type=text] {
        background-color: #f1f1f1;
        width: 100%;
      }
      input[type=submit] {
        background-color: DodgerBlue;
        color: #fff;
        cursor: pointer;
      }
      .autocomplete-items {
        position: absolute;
        border: 1px solid #d4d4d4;
        border-bottom: none;
        border-top: none;
        z-index: 99;
        /*position the autocomplete items to be the same width as the container:*/
        top: 100%;
        left: 0;
        right: 0;
      }
      .autocomplete-items div {
        padding: 10px;
        cursor: pointer;
        background-color: #fff; 
        border-bottom: 1px solid #d4d4d4; 
      }
      /*when hovering an item:*/
      .autocomplete-items div:hover {
        background-color: #e9e9e9; 
      }
      /*when navigating through the items using the arrow keys:*/
      .autocomplete-active {
        background-color: DodgerBlue !important; 
        color: #ffffff; 
      }
      .result_main {
        padding-top: 100px;
      }

      .coneClass {
        position: absolute;
        z-index: 2000;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="coneClass" id="fillingAndDetailsCone">
      <%- include('partials/cone.ejs', { templateExampleFile: "filing_details.png" }) %>
    </div>
    <div class="coneClass" id="companyTimeLineCone">
      <%- include('partials/cone.ejs', { templateExampleFile: "company_timeline.png" }) %>
    </div>
    <div class="coneClass" id="insiderDataCone">
      <%- include('partials/cone.ejs', { templateExampleFile: "insider_data.png" }) %>
    </div>
    <div class="coneClass" id="instantAnalysisCone">
      <%- include('partials/cone.ejs', { templateExampleFile: "instant_analysis.png" }) %>
    </div>

    <nav class="navbar navbar-default mb-0 fixed_nav" style="z-index: 1000;" role="navigation">
      <div class="container-fluid limited">
        <div class="navbar-header">
          <a class="navbar-brand" href="/">
            <img src="/static/images/filling/whitelogo.png" class="title-logo" />
            FilingFindingsâ„¢
          </a>
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target="#navbar-collapse"
          >
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span><span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div
          class="collapse navbar-collapse anonymous-navbar-collapse"
          id="navbar-collapse"
        >
          <form onsubmit="return false;"
            name="search"
            class="navbar-form focus search"
            style="float: right !important;">
            <div class="input-group text-left" style="float: right !important;">
              <input id="searchBox"
                class="form-control search-autocomplete"
                name="ticker"
                size="40"
                placeholder="Ticker or company name"
                autocomplete="off"
                autocorrect="off"
                autocapitalize="off"
                autofocus=""
              />
              <input type="hidden" name="type" value="CIK" />
              <span class="input-group-btn">
                <button id="searchBtn" class="btn btn-default" type="submit">
                  <img
                    src="/static/images/icons/red-5.png"
                    style="width:18px;height:18px;padding:0;margin:0;"
                  />
                </button>
              </span>
            </div>
          </form>
        </div> 
      </div> <!-- Container Fluid END -->
      <center>
        <nav id="nav-2" class="" style="background-color:rgb(240,240,240);padding-bottom:5px;"><!-- ROW -->
          <div class="navbar-collapse collapse" style="max-width: 850px;width: 100%">
            <ul class="nav navbar-nav navbar-center">
              <li class="nav-item"><a class="nav-link bold active" data-toggle="tab" href="#fillingAndDetails" style="color:rgb(51,51,51);font-size: 13px">Filling & Details</a></li>
              <li class="nav-item"><a data-toggle="tab" href="#companyTimeLine" style="color:rgb(51,51,51);font-size: 13px">Company Timeline</a></li>
              <li class="nav-item"><a data-toggle="tab" href="#insiderData" style="color:rgb(51,51,51);font-size: 13px">Insider Data</a></li>
              <li class="nav-item"><a data-toggle="tab" href="#advancedCharts" style="color:rgb(51,51,51);font-size: 13px">Advanced Charts</a></li>
              <li class="nav-item"><a data-toggle="tab" href="#redFlags" style="color:rgb(51,51,51);font-size: 13px">Red Flags</a></li>
              <li class="nav-item"><a data-toggle="tab" href="#instantAnalysis" style="color:rgb(51,51,51);font-size: 13px">Instant Analysis</a></li>
            </ul>
          </div>  
        </nav>
      </center>
    </nav>

    <main class="container result_main">
      <!-- Search result name -->
      <h1 class="text-center"><%- ticker %></h1>

      <div class="row">
        <div class="tab-content">
          <div class="tab-pane active" id="fillingAndDetails" role="tabpanel" aria-labelledby="home-tab">
            <!-- Filters -->
            <div>
              <section id="filter-sec">
                <ul id="filters" class="nav nav-tabs mt-5" style="position: relative;top: 2px;left: 15px">
                  <li class="nav-item">
                    <a class="nav-link active_link" data-value="all" href="#">All</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-value="News" href="#">News</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-value="Financials" href="#">Financials</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-value="Ownership" href="#">Ownership</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-value="Proxies" href="#">Proxies</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-value="Prospectus" href="#">Prospectuses & Registerations</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-value="Other" href="#">Other</a>
                  </li>
                </ul>
              </section>

              <section class="tab-content ticker-tab-content-2" style="padding: 20px;border: 1px solid #ccc;box-shadow: 1px 1px 5px #ccc;">
                <!-- Financial section ( only show for the financial tab ) -->
                <section>
                  <div class="list-group" style="max-width: inherit;">
                    <% const options = { year: "numeric", month: "2-digit", day: "2-digit" }; %>
                    <% filings_list.forEach(filing => { %>
                    <a href="<%- filing.href %>" class="list-group-item list-group-item-action result" data-filter="<%- filing.type %>" style="padding:1rem 1.5rem; margin-bottom: 1.2rem;    padding-bottom: 0;">
                      <div class="row">
                        <div class="col-md-2 bold text-primary ticker" style="max-width:10.4166666625%; flex-basis:10.4166666625%;border-right: 2px solid #b6000e;"><%- filing.ticker %></div>
                        <div class="col-md-6 description" style="max-width:77.0833333025%; flex-basis:77.0833333025%;"><%- filing.description %></div>
                        <div class="col-md-2 text-right" style="max-width:12.499999995%; flex-basis:12.499999995%; border-left: 2px solid #b6000e;display: inline-flex;float: right !important;margin-right: 15px;"><%- new Date(filing.date).toLocaleDateString("en-US", options) %> <i class="fas fa-chevron-right" style="color:#b5b5b5; padding-left:.5rem"></i></div>
                        <div class="col-md-2 collap_menu" style="display: inline-flex;position: relative;bottom: 5px;float: right !important;justify-content: flex-end;">
                        <img src="/static/images/icons/details.png" style="width: 60px;height: 30px" />
                        <img src="/static/images/icons/charts.png" style="width: 50px;height: 30px;" />
                        </div> 
                        <!--<div class="col-md-1 charts">A</div>-->
                        <div class="collapse_panel">
                          <div class="collapse_field"></div>
                        </div>
                      </div>
                    </a>
                    <% }); %>
                  </div>
                </section>
              </section>
            </div>

            <!-- <p>The whole data is here, length is <%- filings_list.length %></p> -->
            <% filings_list.forEach(filing => { %>
            <!-- <p><%- filing.ticker %> || <%- filing.type %></p> -->
            <% }); %>
          </div>
          <div class="tab-pane" id="companyTimeLine" role="tabpanel" aria-labelledby="home-tab">
            <section  class="tab-content ticker-tab-content-2">
              <!-- Financial section ( only show for the financial tab ) -->
              <section style="padding: 15px;">
                <div class="comp_time_panel">
                  <h3>Company Timeline</h3>
                  <div class="comp_time_field">
                    <div class="table-responsive">
                      <table>
                        <tbody>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <img src="/static/images/icons/details.png"/>
                              <span>from 10-Q</span>
                            </td>
                            <td>
                              <label>
                                <img src="/static/images/icons/noF.png"/>
                              </label>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </section>
            </section>
          </div>

          <div class="tab-pane text-center" id="insiderData" role="tabpanel" aria-labelledby="profile-tab">
            <div class="insert_panel">
              <div class="row">
                <div class="col-md-12">
                  <div class="col-md-8 col-xs-12 col-sm-8">
                    <h3 class="ins_tit">Insider Activity</h3>
                    <div class="table-responsive">
                      <table class="insertActivity">
                        <tbody>
                          <tr>
                            <td><label>mm/dd/yyyy</label></td>
                            <td></td>
                            <td>
                              <label>
                              <img src="/static/images/icons/noF.png"/>
                            </label>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <div class="col-md-4 col-xs-12 col-sm-4">
                    <div class="top_direct_hold">
                      <h3>Top Direct Holder</h3>
                      <img src="/static/images/icons/pie_chart.png"/>
                    </div>
                    <div class="officer_exclusive">
                      <h3>Officers & Executives</h3>
                    </div>
                    <div class="insde_trans">
                      <h3>Insider Transactions</h3>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="tab-pane text-center" id="advancedCharts" role="tabpanel" aria-labelledby="messages-tab">This page will be blank</div>
          <div class="tab-pane text-center" id="redFlags" role="tabpanel" aria-labelledby="settings-tab">This page will be blank</div>
          <div class="tab-pane" id="instantAnalysis" role="tabpanel" aria-labelledby="settings-tab">
            <div class="row">
              <div class="container_bar">
                <div class="top_bar">
                  <div class="f_column">
                    <div class="sp_bars">
                      <img src="/static/images/icons/speed.png">
                      <div class="sp_first">bearish</div>
                      <div class="sp_last">bulish</div>
                    </div>
                    <div class="sel_button"><a href="#">Company's Sentiment</a></div>
                  </div>

                  <div class="s_column">
                    <div class="sp_bars">
                      <img src="/static/images/icons/speed.png">
                      <div class="sp_first">Distress</div>
                      <div class="sp_last">Safe</div>
                    </div>
                    <div class="sel_button"><a href="">Bankruptcy Risk</a></div>
                  </div>

                  <div class="t_column">
                    <div class="sp_bars">
                      <img src="/static/images/icons/speed.png">
                      <div class="sp_first">not Manipulator</div>
                      <div class="sp_last">Manipulator</div>
                    </div>
                    <div class="sel_button"><a href="">Manipulator Meter</a></div>
                  </div>

                  <div class="fo_column">
                    <div class="sp_bars">
                      <img src="/static/images/icons/speed.png" />
                      <div class="sp_first">Not Accurate</div>
                      <div class="sp_last">Accurate</div>
                    </div>
                    <div class="sel_button"><a href="">Management's Forecasting</a></div>
                  </div>
                </div>

                <div class="bottom_bar">
                  <div class="f_column">
                    <div class="single_table">
                      <div class="single_row">
                        Variation
                      </div>
                      <div class="single_row">
                        P/E Ratio:
                      </div>
                      <div class="single_row">
                        P/E Normalized EPS:
                      </div>
                      <div class="single_row">
                        Price/Sales:
                      </div>
                      <div class="single_row">
                        Price/Book Value:
                      </div>
                      <div class="single_row">
                        Price/Tangible Book Value:
                      </div>
                      <div class="single_row">
                        PEG Ratio:
                      </div>
                      <div class="single_row">
                        Price/Cash:
                      </div>
                      <div class="single_row">
                        Price/Free Cash Flow:
                      </div>
                      <div class="single_row">
                        Price/Editda:
                      </div>
                      <div class="single_row">
                        Price/Edit:
                      </div>
                      <div class="single_row">
                        Price/Working Capital:
                      </div>
                      <div class="single_row">
                        Forward PE Ratio:
                      </div>
                      <div class="single_row">
                        PEG Piy Back:
                      </div>
                      <div class="single_row">
                        Price/CFO:
                      </div>
                      <div class="single_row">
                        EV to EBITDA:
                      </div>
                    </div>
                  </div>

                  <div class="s_column">
                    <div class="single_table">
                      <div class="single_row">
                        Profitability
                      </div>
                      <div class="single_row">
                        Gross Margin:
                      </div>
                      <div class="single_row">
                        Editda Margin:
                      </div>
                      <div class="single_row">
                        Net Profit Margin:
                      </div>
                      <div class="single_row">
                        Effective Tax Rate:
                      </div>
                      <div class="single_row">
                        Return on Equity:
                      </div>
                      <div class="single_row">
                        Sales Per Employee:
                      </div>
                      <div class="single_row">
                        Pre-Tax Margin:
                      </div>
                      <div class="single_row">
                        ROIC:
                      </div>
                      <div class="single_row">
                        Normalized Net Profit Margin:
                      </div>
                      <div class="single_row">
                        Operation Margin:
                      </div>
                      <div class="single_row">
                        ROA:
                      </div>
                      <div class="single_row">
                        Cash Return:
                      </div>
                    </div>
                  </div>

                  <div class="t_column">
                    <div class="single_table">
                      <div class="single_row">
                        Divident
                      </div>
                      <div class="single_row">
                        Div.Yield:
                      </div>
                      <div class="single_row">
                        Payout Ratio:
                      </div>
                      <div class="single_row">
                        DPS Groft (3yr):
                      </div>          
                    </div>

                    <div class="single_table">
                      <div class="single_row">
                        Leverage
                      </div>
                      <div class="single_row">
                        Debt/Equity:
                      </div>
                      <div class="single_row">
                        Debt/Assets:
                      </div>
                      <div class="single_row">
                        Debt/EBTDA:
                      </div>
                      <div class="single_row">
                        Debt/Cash:
                      </div>
                      <div class="single_row">
                        Interest Coverage:
                      </div>
                      <div class="single_row">
                        Quick Ratio:
                      </div>
                      <div class="single_row">
                        Current Ratio:
                      </div>
                      <div class="single_row">
                        Debt/Capital:
                      </div>
                      <div class="single_row">
                        Financial Leverage:
                      </div>
                    </div>
                  </div>

                  <div class="fo_column">
                    <div class="single_table">
                      <div class="single_row">
                        Strength
                      </div>
                      <div class="single_row">
                        Cash-To-Debt
                      </div>
                      <div class="single_row">
                        Equity-To-Asset
                      </div>
                      <div class="single_row">
                        Debt-To-Equity
                      </div>
                      <div class="single_row">
                        Debt-To-EBITDA
                      </div>
                      <div class="single_row">
                        Interest Coverage
                      </div>
                      <div class="single_row">
                        Piotroski F-Score
                      </div>
                      <div class="single_row">
                        Altman Z-Score
                      </div>
                      <div class="single_row">
                        Beneish M-Score
                      </div>
                      <div class="single_row">
                        WACC vs ROYC
                      </div>
                    </div>
                    
                    <div class="single_table">
                      <div class="single_row">
                        Growth
                      </div>
                      <div class="single_row">
                        Diluted EPS Growth (3yr):
                      </div>
                      <div class="single_row">
                        Sustainable Growth:
                      </div>
                      <div class="single_row">
                        Revenu Growth (5yr):
                      </div>
                      <div class="single_row">
                        Operation Income Growth (5yr):
                      </div>
                      <div class="single_row">
                        Gross Profit Annual 5yr Growth:
                      </div>
                      <div class="single_row">
                        Capital Expenditure Annual 5yr Growth:
                      </div>
                      <div class="single_row">
                        Net Income Growth (5yr):
                      </div>
                    </div>      
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    
    <%- include("partials/footer") %>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.0.0/dist/fetch.umd.min.js"></script>
    <script>
      function autocomplete(inp, companies, ticker) {
        /*the autocomplete function takes two arguments,
        the text field element and an array of possible autocompleted values:*/
        var currentFocus;
        /*execute a function when someone writes in the text field:*/
        inp.addEventListener("input", function(e) {
            var a, b, i, val = this.value;
            /*close any already open lists of autocompleted values*/
            closeAllLists();
            if (!val) { return false;}
            currentFocus = -1;
            /*create a DIV element that will contain the items (values):*/
            a = document.createElement("DIV");
            a.setAttribute("id", this.id + "autocomplete-list");
            a.setAttribute("class", "autocomplete-items");
            /*append the DIV element as a child of the autocomplete container:*/
            this.parentNode.appendChild(a);
          /*filter array possibilities*/
          var newArr = companies.filter(c => {return c.toUpperCase().startsWith(val.toUpperCase())});
            /*for each item in the array...*/
            for (i = 0; i < 7; i++) {
              /*check if the item starts with the same letters as the text field value:*/
              if (newArr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
                /*create a DIV element for each matching element:*/
                b = document.createElement("DIV");
                /*make the matching letters bold:*/
                b.innerHTML = "<strong>" + newArr[i].substr(0, val.length) + "</strong>";
                b.innerHTML += newArr[i].substr(val.length);
                /*insert a input field that will hold the current newArray item's value:*/
                b.innerHTML += "<input type='hidden' value='" + newArr[i] + "'>";
                /*execute a function when someone clicks on the item value (DIV element):*/
                b.addEventListener("click", function(e) {
                    /*insert the value for the autocomplete text field:*/
                    inp.value = this.getElementsByTagName("input")[0].value;
                    /*close the list of autocompleted values,
                    (or any other open lists of autocompleted values:*/
                    closeAllLists();
                });
                a.appendChild(b);
              }
            }
        });
        /*execute a function presses a key on the keyboard:*/
        inp.addEventListener("keydown", function(e) {
            var x = document.getElementById(this.id + "autocomplete-list");
            if (x) x = x.getElementsByTagName("div");
            if (e.keyCode == 40) {
              /*If the arrow DOWN key is pressed,
              increase the currentFocus variable:*/
              currentFocus++;
              /*and and make the current item more visible:*/
              addActive(x);
            } else if (e.keyCode == 38) { //up
              /*If the arrow UP key is pressed,
              decrease the currentFocus variable:*/
              currentFocus--;
              /*and and make the current item more visible:*/
              addActive(x);
            } else if (e.keyCode == 13) {
              if (currentFocus > -1) {
            /*If the ENTER key is pressed, prevent the form from being submitted,*/
                e.preventDefault();
            /*and simulate a click on the "active" item:*/
                if (x) x[currentFocus].click();
              }
            }
        });
        function addActive(x) {
          /*a function to classify an item as "active":*/
          if (!x) return false;
          /*start by removing the "active" class on all items:*/
          removeActive(x);
          if (currentFocus >= x.length) currentFocus = 0;
          if (currentFocus < 0) currentFocus = (x.length - 1);
          /*add class "autocomplete-active":*/
          x[currentFocus].classList.add("autocomplete-active");
        }
        function removeActive(x) {
          /*a function to remove the "active" class from all autocomplete items:*/
          for (var i = 0; i < x.length; i++) {
            x[i].classList.remove("autocomplete-active");
          }
        }
        function closeAllLists(elmnt) {
          /*close all autocomplete lists in the document,
          except the one passed as an argument:*/
          var x = document.getElementsByClassName("autocomplete-items");
          for (var i = 0; i < x.length; i++) {
            if (elmnt != x[i] && elmnt != inp) {
              x[i].parentNode.removeChild(x[i]);
            }
          }
        }
        /*execute a function when someone clicks in the document:*/
        document.addEventListener("click", function (e) {
            closeAllLists(e.target);
        });
      }

      $(document).ready(function(){
        $(document).on("click", ".collap_menu>img:eq(0)", function(){
          const collapsePanel = $(this).parent().parent().find(".collapse_panel")
          if(collapsePanel.css('height') == '0px') {
            collapsePanel
              .css({
                'height': '120px',
                '-webkit-transition': 'all 1s',
                '-moz-transition': 'all 1s',
                '-ms-transition': 'all 1s',
                '-o-transition': 'all 1s',
                'transition': 'all 1s'
              });
          } else {
            collapsePanel
              .css({
                'height': '0px',
                '-webkit-transition': 'all 1s',
                '-moz-transition': 'all 1s',
                '-ms-transition': 'all 1s',
                '-o-transition': 'all 1s',
                'transition': 'all 1s'
              });
          }

          $(document).on("mouseenter", ".collap_menu>img:eq(0), .comp_time_field>div>table>tbody>tr>td:eq(2)>img", function(){
            $(this).attr("src", "/static/images/icons/detail_hover.png")
          });
          $(document).on("mouseenter", ".collap_menu>img:eq(1)", function(){
            $(this).attr("src", "/static/images/icons/chart_hover.png")
          });
          $(document).on("mouseleave", ".collap_menu>img:eq(0), .comp_time_field>div>table>tbody>tr>td:eq(2)>img", function(){
            $(this).attr("src", "/static/images/icons/details.png")
          });
          $(document).on("mouseleave", ".collap_menu>img:eq(1)", function(){
            $(this).attr("src", "/static/images/icons/charts.png")
          });
        });

        /*An array containing companies:*/
        const companies = [];
        const ticker = [];
        fetch('/static/text/data.txt')
          .then(data => data.text())
          .then(data => data.split('\n').map(data => data.split(/\s+/)))
          .then(data => {
            for (const item of data) {
              const [first, ...rest] = item;

              companies.push(rest.join(" ").trim());
              ticker.push(first.trim());
            }
          }, 'text');

        autocomplete(document.getElementById("searchBox"), companies, ticker);

        $('.search').on('submit', function (value) {
          let tickerSearchValue = document.forms["search"]["ticker"].value;
          if(companies.includes(tickerSearchValue)) {
            tickerSearchValue = companies.indexOf(tickerSearchValue);
          }

          const uri = window.location.href.split("/")
          window.location.href = uri[0] + "//" + uri[2] + "/result?ticker=" + tickerSearchValue + "&type=CIK";
        });

        // cleaning up the data
        $('.result').each(function() {
          $(this).data("filter", $(this).data("filter").trim());
        });

        // Select filter
        $('#filters a').each(function() {
          $(this).click(() => {
            // Add styles to the link element
            $('#filters a').removeClass("active_link");
            $(this).addClass('active_link');

            // Apply filtering
            if ($(this).data("value") === 'all') {
              $('.result').removeClass('d-none');
              $('#financiaData').addClass('d-none');
              return;
            }
        
            // Hide all
            $('.result').addClass('d-none');
        
            // Display what you want only
            $(`[data-filter="${$(this).data("value")}"]`).removeClass('d-none');
        
            // show financial section for financial filter
            $('#financiaData')[$(this).data("value") == 'Financials' ? "removeClass" : "addClass"]('d-none');
          })
        });
        
        // append -Amended to the tricker if it includes "/a"
        $('.result').each(function() {
          const content = $(this).find('.ticker').html();
          if (content.includes('/A')) {
            $(this).find('.description').html(`${$(this).find('.description').html()} -Amended`);
          }
        })
        return false;
      });
    </script>
  </body>
</html>
